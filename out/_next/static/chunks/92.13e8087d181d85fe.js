"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[92],{6663:function(t,e,n){n.d(e,{Di:function(){return a},IM:function(){return o},LF:function(){return m},NG:function(){return l},PY:function(){return c},Rg:function(){return u},eR:function(){return s},p6:function(){return d},sU:function(){return i}});var r=n(3915);let o=(0,r.cn)(!0),a=(0,r.cn)(null),c=(0,r.cn)(!1),i=(0,r.cn)(null),s=(0,r.cn)(!1),l=(0,r.cn)(null),u=(0,r.cn)(!1),m=(0,r.cn)((()=>{{let t=localStorage.getItem("user");return t?JSON.parse(t):null}})(),(t,e,n)=>{if(e(m,n),n){let t={id:n._id,email:n.email,token:n.token};n.name&&(t.name=n.name),n.image&&(t.image=n.image),n.role&&(t.role=n.role),localStorage.setItem("user",JSON.stringify(t))}else localStorage.removeItem("user")}),d=(0,r.cn)(t=>!!t(m))},2092:function(t,e,n){n.r(e);var r=n(7437),o=n(2964),a=n(6663),c=n(8614),i=n(521),s=n(2744),l=n(2265),u=n(9463),m=n(3525),d=n(4438);e.default=()=>{let[t,e]=(0,o.KO)(a.eR),[n,h]=(0,o.KO)(a.NG),[f,g]=(0,l.useState)(""),[p,x]=(0,l.useState)(!1),[b,y]=(0,o.KO)(a.LF);if(!n||!n.blog)return null;let{blog:w,comments:v}=n,j=()=>{e(!1),g("")},N=async t=>{if(t.preventDefault(),f.trim()){x(!0);try{if(!b||!b.token){d.Am.error("You must be logged in to submit a comment."),x(!1);return}let t=b.name||b.email,e={...await (0,u.Ir)({blogId:w._id,author:t,content:f},b.token),author:{name:t}};h(t=>({...t,comments:[e,...t.comments]})),n.onCommentAdded&&n.onCommentAdded(e),g("")}catch(t){console.log(t),(0,m.M)(t),d.Am.error("Failed to submit comment.")}finally{x(!1)}}};return(0,r.jsx)(c.M,{children:t&&(0,r.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/90",onClick:j,children:(0,r.jsxs)(i.E.div,{initial:{y:"-100vh",opacity:0},animate:{y:"0",opacity:1},exit:{y:"100vh",opacity:0},transition:{type:"spring",stiffness:100,damping:20},className:"custom-bg relative mx-4 w-full max-w-3xl rounded-xl p-2 shadow-lg sm:p-4",onClick:t=>t.stopPropagation(),children:[(0,r.jsx)("button",{onClick:j,className:"absolute right-4 top-4 text-3xl text-orange-500 hover:text-orange-200",children:(0,r.jsx)(s.FU5,{})}),(0,r.jsxs)("h2",{className:"mb-4 text-center text-3xl font-bold text-white",children:["Comments for ",w.title]}),(0,r.jsx)("div",{className:"blog-modal-content max-h-[40vh] overflow-y-auto p-6 text-white",children:v.length>0?v.map(t=>(0,r.jsxs)("div",{className:"mb-4 border-b border-gray-700 pb-2 last:border-b-0",children:[(0,r.jsx)("p",{className:"font-bold",children:t.author.name||"N/A"}),(0,r.jsx)("p",{children:t.text}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:new Date(t.createdAt).toLocaleString()})]},t._id)):(0,r.jsx)("p",{className:"text-center",children:"No comments yet."})}),(0,r.jsxs)("form",{onSubmit:N,className:"mt-4 p-6",children:[(0,r.jsx)("textarea",{className:"w-full rounded-md border border-gray-700 bg-gray-800 p-2 text-white focus:border-orange-500 focus:outline-none",rows:"3",placeholder:"Write a comment...",value:f,onChange:t=>g(t.target.value)}),(0,r.jsx)(i.E.button,{type:"submit",className:"custom-bg mt-2 rounded-full px-4 py-2 text-foreground transition-colors hover:text-orange-500 disabled:opacity-50",disabled:p,whileHover:{scale:1.05},whileTap:{scale:.95},children:p?"Submitting...":"Submit Comment"})]})]})})})}},3525:function(t,e,n){n.d(e,{M:function(){return o}});var r=n(4438);let o=t=>{let e=(null==t?void 0:t.message)||String(t);if(console.error("Unauthorized error caught:",e),e.includes("401")){let t=new CustomEvent("unauthorized-event");window.dispatchEvent(t),r.Am.error("Your session has expired. Please log in again.")}}},9463:function(t,e,n){n.d(e,{Hp:function(){return c},Ir:function(){return i},Mx:function(){return o},tH:function(){return a}}),n(3525);let r="https://blogs-galaxy-server.onrender.com/api",o=async(t,e,n)=>{try{let o=await fetch("".concat(r,"/blogs/").concat(t,"/rate"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({action:n})});if(!o.ok)throw Error("HTTP error! status: ".concat(o.status));return await o.json()}catch(t){throw t}},a=async t=>{try{let e=await fetch("".concat(r,"/comments/blog/").concat(t));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return await e.json()}catch(t){throw t}},c=async t=>{try{let e=await fetch("".concat(r,"/blogs/").concat(t));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return await e.json()}catch(t){throw t}},i=async(t,e)=>{try{let n=await fetch("".concat(r,"/comments"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({text:t.content,blogId:t.blogId,author:t.author})});if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));return await n.json()}catch(t){throw t}}}}]);